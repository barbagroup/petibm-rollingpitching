# Independence study

The present directory contains all the input files and post-processing scripts, of the PetIBM simulations for the independence study conducted for the replication.

## Contents

* `scripts`: Python scripts for post-processing
* `figures`: output figures (generated by the Python scripts)
* `run*`: simulation folders of the independence study
  * `run1`: coarse-grid simulation with grid-cell width $\Delta x / c = 0.03$
  * `run2`: intermediate-grid simulation with grid-cell width $\Delta x / c = 0.015$
  * `run3`: nominal-grid simulation with grid-cell width $\Delta x / c = 0.01$
  * `run4`: fine-grid simulation with grid-cell width $\Delta x / c = 0.005$
  * `run5`: nominal-grid simulation with a 3%-thickness disk
  * `run6`: coarser temporal grid with only 1000 time steps per flapping cycle
  * `run7`: nominal-grid simulation with tighter exit criterion for the iterative solvers

## Post-processing steps

To generate the figures of the manuscript:

```shell
cd <directory-of-this-README>
docker run --rm -it -v $(pwd):/postprocessing mesnardo/petibm-rollingpitching:prepost /bin/bash /postprocessing/scripts/generate_figures.sh
```

Alternatively, you can log into the Docker container and generate figure by figure:

```shell
cd <directory-of-this-README>
docker run --rm -it -v $(pwd):/postprocessing mesnardo/petibm-rollingpitching:prepost /bin/bash
cd /postprocessing  # inside the container
```

then run the instructions displayed in the following sub-sections.

### History of the force coefficients (comparing grid-cell widths)

* Script: `scripts/plot_force_coefficients_compare.dx.py`
* Simulation requirements:
  * `run1`
  * `run3`
  * `run4`
* Output: `figures/force_coefficients_compare_dx.png`
* CLI:

  ```shell
  python scripts/plot_force_coefficients_compare_dx.py
  ```

![fig:force_coefficients_compare_dx](figures/force_coefficients_compare_dx.png)

### History of the force coefficients (comparing time-step sizes)

* Script: `scripts/plot_force_coefficients_compare_dt.py`
* Simulation requirements:
  * `run3`
  * `run6`
* Output: `figures/force_coefficients_compare_dt.png`
* CLI:

  ```shell
  python scripts/plot_force_coefficients_compare_dt.py
  ```

![fig:force_coefficients_compare_dt](figures/force_coefficients_compare_dt.png)

### History of the force coefficients (comparing flat/disk)

* Script: `scripts/plot_force_coefficients_compare_disk.py`
* Simulation requirements:
  * `run3`
  * `run5`
* Output: `figures/force_coefficients_compare_disk.png`
* CLI:

  ```shell
  python scripts/plot_force_coefficients_compare_disk.py
  ```

![fig:force_coefficients_compare_disk](figures/force_coefficients_compare_disk.png)

### History of the force coefficients (comparing nominal/tighter exit criterion for iterative solvers)

* Script: `scripts/plot_force_coefficients_compare_atol.py`
* Simulation requirements:
  * `run3`
  * `run7`
* Output: `figures/force_coefficients_compare_atol.png`
* CLI:

  ```shell
  python scripts/plot_force_coefficients_compare_atol.py
  ```

![fig:force_coefficients_compare_atol](figures/force_coefficients_compare_atol.png)

### Profile of the velocity components in the wake (comparing grid-cell widths and time-step sizes)

* Script: `scripts/plot_velocity_profiles_compare_dx_dt.py`
* Simulation requirements:
  * `run3`
  * `run4`
  * `run6`
* Output:
  * `figures/ux_profiles_compare_dx_dt.png`
  * `figures/uy_profiles_compare_dx_dt.png`
  * `figures/uz_profiles_compare_dx_dt.png`
* CLI:

  ```shell
  python scripts/plot_velocity_profiles_compare_dx_dt.py
  ```

Example: `figures/ux_profiles_compare_dx_dt.png`

![fig:ux_profiles_dx_dt](figures/ux_profiles_compare_dx_dt.png)

### Profile of the fluctuations of the kinetic energy in the wake (comparing grid-cell widths and time-step sizes)

* Script: `scripts/plot_kinetic_profiles_compare_dx_dt.py`
* Simulation requirements:
  * `run3`
  * `run4`
  * `run6`
* Output: `figures/kin_profiles_compare_dx_dt.png`
* CLI:

  ```shell
  python scripts/plot_kinetic_profiles_compare_dx_dt.py
  ```

![fig:kin_profiles_dx_dt](figures/kin_profiles_compare_dx_dt.png)

### Profile of the velocity components in the wake (comparing flat plate and disk)

* Script: `scripts/plot_velocity_profiles_compare_disk.py`
* Simulation requirements:
  * `run3`
  * `run5`
* Output:
  * `figures/ux_profiles_compare_disk.png`
  * `figures/uy_profiles_compare_disk.png`
  * `figures/uz_profiles_compare_disk.png`
* CLI:

  ```shell
  python scripts/plot_velocity_profiles_compare_disk.py
  ```

Example: `figures/ux_profiles_compare_disk.png`

![fig:ux_profiles_disk](figures/ux_profiles_compare_disk.png)

### Profile of the fluctuations of the kinetic energy in the wake (comparing flat plate and disk)

* Script: `scripts/plot_kinetic_profiles_compare_disk.py`
* Simulation requirements:
  * `run3`
  * `run5`
* Output: `figures/kin_profiles_compare_disk.png`
* CLI:

  ```shell
  python scripts/plot_kinetic_profiles_compare_disk.py
  ```

![fig:kin_profiles_disk](figures/kin_profiles_compare_disk.png)

### Slices of the streamwise vorticity at t/T = 4.25 (on nominal grid)

* Script: `scripts/get_wx_distances.py`
* Simulation requirements: `run3`
* Output:
  * `figures/wx_slice_c_distances.png`
  * `figures/wx_slice_f_distances.png`
* CLI:

  ```shell
  python scripts/get_wx_distances.py
  ```

Example: `figures/wx_slice_c_distances.png`

![fig:wx_slice_distances](figures/wx_slice_c_distances.png)
